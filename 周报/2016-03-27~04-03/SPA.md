# 单页应用（Single Page Application, SPA）
  单页应用是指在一个页面上集成多种功能，甚至整个系统只有一个页面，所有的业务功能都是它的子模块，通过特定的方式挂接到主界面上。它是Ajax技术的进一步升华，把Ajax的无刷新机制发挥到极致，因此造就了与桌面程序媲美的用户体验。<br>
  单页应用对于我们并不陌生，ExtJS是第一代单页应用框架，也有人用jQuery或者其他框架实现过类似的东西。用各种JS框架，都是可以实现单页应用的，它只是一种理念。
## 开发框架
  ExtJS是第一代单页应用框架的典型，它封装了各种UI组件，用户主要使用JavaScript来完成整个前端部分，甚至包括布局。随着功能逐渐增加，ExtJS的体积页逐渐增大，即使用于内部系统的开发，也显得笨重，不适合于运行在互联网上的系统。<br>
  jQuery由于偏重DOM操作，它的插件体系又比较松散，所以比ExtJS这个体系更适合开发在公网运行的单页系统，整个解决方案会相对比较轻量、灵活。但由于jQuery主要面向上层操作，对代码的阻止缺乏约束。如何在代码急剧膨胀的情况下控制每个模块的内聚性，并且适当在模块之间产生数据传递和共享，就成为了一种有挑战的事情。<br>
  为了解决单页应用大规模增长时代码逻辑，出现了不少MV*框架，它们的基本思路都是在JS层创建模块分层和通信机制。常见的有MVC、MVP和MVVM。<br>
### MVC：Model-View-Control
  常见的有Backbone.js
### MVP：Model-View-Presenter
  
### MVVM：Model-View-ViewModel
  MVVM与MVC和MVP最大的区别在于，MVVM支持数据双向绑定：View的变动会自动反应在ViewModel，反之亦然。开发人员不用再把精力放在DOM的修改和更新，只要通过模板引擎将数据好用户界面绑定，框架会实时同步双方的数据变化。减轻开发人员的负担，也减少DOM操作逻辑导致业务逻辑混乱的可能性。
  常见的有Angular.js、React.js、Ember.js、Vue.js、Knockout.js
## 组件化
  这些在前端做分层的框架推动了代码的组件化，所谓组件化，在传统的Web产品中，更多的是指UI组件，但其实组件是一个广泛的概念，传统Web产品中UI组件占比高的原因是它的厚度不足，随着客户端代码比例的增加，相当一部分的业务逻辑也前端化，由此催生了很多非界面型组件的出现。<br>
  分层带来的一个好处是，每层的职责更加专一，因此可以对其作单元测试的覆盖，以保障其质量。传统UI层测试最头疼的问题是UI层和逻辑混杂在一起，比如往往会在远程请求的回调中更改DOM，当引入分层之后，这些东西都可以分别被测试，然后再通过场景测试来保证整体流程。
## 代码隔离
  从单页应用的特点来看，它比页面型网站更加依赖于JavaScript，而由于页面的单页化，各种子功能的JavaScript代码聚集到同一个作用域，所以代码的隔离、模块化变得很重要。<br>
  在单页应用中，页面模板的使用是很普遍的。很多框架内置了特定的模板，也有的框架需要引入第三方的模板。这种模板是界面片段，我们可以把它们类比成JavaScript模块，它们是另一种类型的组件。<br>
  模板也一样有隔离的需要。不隔离的模板有可能会造成模板冲突。模板间的冲突主要存在于id属性上，如果一个模板中包含固定的id，当它被批量渲染的时候，会造成一个页面的作用域中出现多个相同id的元素。因此我们需要在模板中避免使用id，如果有对DOM的访问需求，应该通过其他选择器来完成。
## 代码合并与加载策略
  用户对单页应用系统的加载时间容忍度与Web页面不同，假设一般用户愿意为购物车页面的加载等待3秒，有可能会愿意为单页应用的首次加载等待5-10秒，但在此之后，各种功能的使用应当比较顺畅，所有子功能页面要在1~2秒时间内切换成功，否则他们就会感觉这个系统很慢。<br>
  由于上述原因，我们可以把更多的功能功能放到首次加载，以减少每次加载的载入量，有一些站点甚至把所有的界面和逻辑全部放到首次加载，每次业务切换的时候，只产生数据请求，因此它的响应是非常迅速的。<br>
  通常在单页应用中，无需像网站型产品一样，为了防止文件加载阻塞渲染而把JS文件放到html后加载，因为单页应用的界面基本都是动态生成的。<br>
  当切换功能的时候，除了产生数据请求，还需要渲染界面，这个新渲染的界面部件一般是界面模板，它的来源无非有两种，一种是即时请求，像请求数据那样通过Ajax获取，另一种是内置于主界面的某些位置，比如script标签或看不见的textarea中，后者在切换功能的时候速度有优势，但加重了主页面的负担。<br>
  在传统的页面型网站中，页面之间是互相隔离的，因此，如果在页面间存在可复用的代码，一般是提取成单独的文件，并且可能会需要按照每个页面的需求去进行合并。单页应用中，如果总的代码量不大，可以整体打包一次在首页载入，如果大到一定规模，再做运行时加载，加载的粒度可以搞得比较大，不同的块之间没有重复部分。
  https://github.com/xufei/blog/issues/5
  